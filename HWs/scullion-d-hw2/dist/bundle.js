/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e,t,n,o,r,i,a,s,l=Object.freeze({gain:.5,numSamples:256}),c=(new Uint8Array(l.numSamples/2),function(c){var d=window.AudioContext||window.webkitAudioContext;t=new d,(n=new Audio).crossOrigin="anonymous";var h=document.querySelector("#update-message");c.includes("undefined")?h.innerHTML="No available tracks.":u(c),(o=t.createMediaElementSource(n)).mediaElement.onended=function(){0==o.mediaElement.loop&&(document.querySelector("#play-button").dataset.playing="no")},(a=t.createBiquadFilter()).type="highshelf",(s=t.createBiquadFilter()).type="lowshelf",(r=t.createAnalyser()).fftSize=l.numSamples,o.connect(a),a.connect(s),s.connect(r),(i=t.createGain()).gain.value=l.gain,o.connect(r),r.connect(i),i.connect(t.destination);var f=document.querySelector("#progress-bar");n.addEventListener("timeupdate",(function(){f.value=n.currentTime/n.duration*100})),f.addEventListener("input",(function(){n.currentTime=f.value/100*n.duration}));var p=document.querySelector("#time-tracker");function m(e){var t=Math.floor(e/60),n=Math.floor(e%60);return"".concat(t,":").concat(n.toString().padStart(2,"0"))}n.addEventListener("timeupdate",(function(){var t=m(n.currentTime);e<t?e+.3>=t&&(e=t):e=p.textContent.split(" / ")[1],p.textContent="".concat(t," / ").concat(e)})),n.addEventListener("loadedmetadata",(function(){f.value=0;var t=m(n.currentTime);e=m(n.duration),p.textContent="".concat(t," / ").concat(e)}))}),u=function(e){var t=document.querySelector("#update-message");n.addEventListener("error",(function(){t.innerHTML="Track was removed after server update. Please reupload."})),n.src="NaN"!=e?e:"./uploads/silence.mp3",n.removeEventListener("error",(function(){t.innerHTML="Track was removed after server update. Please reupload."}))},d=function(e){e=Number(e),i.gain.value=e},h=function(e){o.mediaElement.loop=e};function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var p=function(e,t,n,o){var r,i=Math.sqrt(t*t*.8+n*n*.8),a=o.angle*Math.PI/180,s=t/2-Math.cos(a)*i/2,l=n/2-Math.sin(a)*i/2,c=t/2+Math.cos(a)*i/2,u=n/2+Math.sin(a)*i/2,d=e.createLinearGradient(s,l,c,u),h=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(o.colorStops);try{for(h.s();!(r=h.n()).done;){var p=r.value;d.addColorStop(p.percent,p.color)}}catch(e){h.e(e)}finally{h.f()}return d};function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function _(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,r=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==m(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===m(r)?r:String(r)),o)}var r}function g(e,t,n){return t&&_(e.prototype,t),n&&_(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var v=g((function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n,this.z=o,this.sx=t,this.sy=n,this.sz=o}));function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function w(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,r=function(e,t){if("object"!==b(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==b(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===b(r)?r:String(r)),o)}var r}var x=function(){function e(t,n,o,r,i,a,s,l,c,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvasWidth=o,this.canvasHeight=r,this.boundry=new Array,this.radius=n,this.numberOfVertices=0,this.numberOfRings=i,this.constant=2*Math.PI/a,this.rings=[],this.ctx=t,this.totalX=0,this.totalY=0,this.totalZ=0,this.frontColor1=this.hexToRgb(s.substring(1,7)),this.frontColor2=this.hexToRgb(l.substring(1,7)),this.backColor1=this.hexToRgb(c.substring(1,7)),this.backColor2=this.hexToRgb(u.substring(1,7));for(var d=0;d<=2*Math.PI;d+=this.constant)this.boundry[this.numberOfVertices]=new v(Math.cos(d)*this.radius,0,Math.sin(d)*this.radius),this.numberOfVertices++;for(var h=1;h>=-1;h-=2)for(var f=0;f<this.numberOfRings;f++){var p=f/this.numberOfRings*(Math.PI/2),m=Math.cos(p)*this.radius,_=Math.sin(p)*this.radius*h;if(0!=_)for(var g=0;g<6.28;g+=this.constant)this.boundry[this.numberOfVertices]=new v(Math.cos(g)*m,_,Math.sin(g)*m),this.numberOfVertices++}var b=this.boundry[0].sy,y=this.boundry[0],w=0,x=0;this.rings[0]=new Array;for(var S=0;S<this.numberOfVertices;S++)this.boundry[S].sy!=b?(b=this.boundry[S].sy,y=this.boundry[S],w++,x=0,this.rings[w]=new Array,this.rings[w][x]=y,x++):(this.rings[w][x]=this.boundry[S],x++);for(var C=0;C<this.rings.length;C++)for(var E=0;E<this.rings.length-C-1;E++)if(this.rings[E][0].sy>this.rings[E+1][0].sy){var k=this.rings[E];this.rings[E]=this.rings[E+1],this.rings[E+1]=k}}var t,n;return t=e,n=[{key:"drawSphere",value:function(e,t){var n,o=this.ctx,r=this.canvasWidth,i=this.canvasHeight,a=new Array(this.rings.length);n=this.rings[0],this.finalRotation();for(var s=128/this.rings.length,l=0;l<this.rings.length;l++)if(t){for(var c=0,u=Math.round(s*l);u<Math.round(s*(l+1));u++)c+=e[u];c/=Math.round(s*(l+1))-Math.round(s*l),a[l]=c/255/2+1}else a[l]=1;o.lineWidth=3;var d,h=new Array(this.rings.length),f=new Array(this.rings.length);for(d=0;d<this.rings.length;d++,n=this.rings[d]){o.beginPath();var p=-1;if(n[0].z<=0&&n[n.length-1].z>=0){p=0;var m=this.slerp(n[0],n[n.length-1]);h[d]=m,o.lineTo(r/2+m.x*a[d],i/2-m.y*a[d])}else{for(var _=1;_<n.length;_++)if(n[_].z<=0&&n[_-1].z>=0){p=_;var g=this.slerp(n[_],n[_-1]);h[d]=g,o.lineTo(r/2+g.x*a[d],i/2-g.y*a[d]);break}if(-1==p){if(n[0].z>0){o.stroke();continue}for(var v=0;v<n.length-1;v++)o.lineTo(r/2+n[v].x*a[d],i/2-n[v].y*a[d]);var b=this.blendColors(this.backColor1,this.backColor2,a[d]);o.strokeStyle="rgb(".concat(b[0],", ").concat(b[1],", ").concat(b[2],")"),o.closePath(),o.stroke();continue}}o.lineTo(r/2+n[p].x*a[d],i/2-n[p].y*a[d]);for(var y=p+1;-1!=y;y++){if(y==n.length&&(y=0),n[y].z>=0){if(0==y&&0!=p){var w=this.slerp(n[0],n[n.length-1]);f[d]=w,o.lineTo(r/2+w.x*a[d],i/2-w.y*a[d])}else{var x=this.slerp(n[y],n[y-1]);f[d]=x,o.lineTo(r/2+x.x*a[d],i/2-x.y*a[d])}var S=this.blendColors(this.backColor1,this.backColor2,a[d]);o.strokeStyle="rgb(".concat(S[0],", ").concat(S[1],", ").concat(S[2],")"),o.stroke();break}o.lineTo(r/2+n[y].x*a[d],i/2-n[y].y*a[d])}}for(n=this.rings[this.rings.length-1],d=this.rings.length-1;d>=this.rings.length-Math.floor(this.rings.length/4);d--,n=this.rings[d])if(null==f[d]){if(n[0].z<0)continue;o.beginPath(),o.lineTo(r/2+n[0].x*a[d],i/2-n[0].y*a[d]);for(var C=1;C<n.length;C++)o.lineTo(r/2+n[C].x*a[d],i/2-n[C].y*a[d]);var E=this.blendColors(this.frontColor1,this.frontColor2,a[d]);o.strokeStyle="rgb(".concat(E[0],", ").concat(E[1],", ").concat(E[2],")"),o.closePath(),o.stroke()}else{o.beginPath();var k=-1;if(n[0].z>=f[d].z&&n[n.length-1].z<=f[d].z)k=0,o.lineTo(r/2+f[d].x*a[d],i/2-f[d].y*a[d]);else for(var A=1;A<n.length;A++)if(n[A].z>=f[d].z&&n[A-1].z<=f[d].z){k=A,o.lineTo(r/2+f[d].x*a[d],i/2-f[d].y*a[d]);break}o.lineTo(r/2+n[k].x*a[d],i/2-n[k].y*a[d]);for(var T=k+1;-1!=k&&T!=k;T++){if(T==n.length&&(T=0),n[T].z<=h[d].z){o.lineTo(r/2+h[d].x*a[d],i/2-h[d].y*a[d]);var O=this.blendColors(this.frontColor1,this.frontColor2,a[d]);o.strokeStyle="rgb(".concat(O[0],", ").concat(O[1],", ").concat(O[2],")"),o.stroke();break}o.lineTo(r/2+n[T].x*a[d],i/2-n[T].y*a[d])}}for(n=this.rings[Math.floor(this.rings.length/4)+1],d=Math.floor(this.rings.length/4)+1;d<this.rings.length-Math.floor(this.rings.length/4);d++,n=this.rings[d])if(null==f[d]){if(n[0].z<0)continue;o.beginPath(),o.lineTo(r/2+n[0].x*a[d],i/2-n[0].y*a[d]);for(var L=1;L<n.length;L++)o.lineTo(r/2+n[L].x*a[d],i/2-n[L].y*a[d]);var M=this.blendColors(this.frontColor1,this.frontColor2,a[d]);o.strokeStyle="rgb(".concat(M[0],", ").concat(M[1],", ").concat(M[2],")"),o.closePath(),o.stroke()}else{o.beginPath();var P=-1;if(n[0].z>=f[d].z&&n[n.length-1].z<=f[d].z)P=0,o.lineTo(r/2+f[d].x*a[d],i/2-f[d].y*a[d]);else for(var R=1;R<n.length;R++)if(n[R].z>=f[d].z&&n[R-1].z<=f[d].z){P=R,o.lineTo(r/2+f[d].x*a[d],i/2-f[d].y*a[d]);break}o.lineTo(r/2+n[P].x*a[d],i/2-n[P].y*a[d]);for(var B=P+1;-1!=P&&B!=P;B++){if(B==n.length&&(B=0),n[B].z<=h[d].z){o.lineTo(r/2+h[d].x*a[d],i/2-h[d].y*a[d]);var z=this.blendColors(this.frontColor1,this.frontColor2,a[d]);o.strokeStyle="rgb(".concat(z[0],", ").concat(z[1],", ").concat(z[2],")"),o.stroke();break}o.lineTo(r/2+n[B].x*a[d],i/2-n[B].y*a[d])}}for(n=this.rings[Math.floor(this.rings.length/4)],d=Math.floor(this.rings.length/4);d>=0;d--,n=this.rings[d])if(null==f[d]){if(n[0].z<0)continue;o.beginPath(),o.lineTo(r/2+n[0].x*a[d],i/2-n[0].y*a[d]);for(var N=1;N<n.length;N++)o.lineTo(r/2+n[N].x*a[d],i/2-n[N].y*a[d]);var j=this.blendColors(this.frontColor1,this.frontColor2,a[d]);o.strokeStyle="rgb(".concat(j[0],", ").concat(j[1],", ").concat(j[2],")"),o.closePath(),o.stroke()}else{o.beginPath();var F=-1;if(n[0].z>=f[d].z&&n[n.length-1].z<=f[d].z)F=0,o.lineTo(r/2+f[d].x*a[d],i/2-f[d].y*a[d]);else for(var H=1;H<n.length;H++)if(n[H].z>=f[d].z&&n[H-1].z<=f[d].z){F=H,o.lineTo(r/2+f[d].x*a[d],i/2-f[d].y*a[d]);break}o.lineTo(r/2+n[F].x*a[d],i/2-n[F].y*a[d]);for(var I=F+1;-1!=F&&I!=F;I++){if(I==n.length&&(I=0),n[I].z<=h[d].z){o.lineTo(r/2+h[d].x*a[d],i/2-h[d].y*a[d]);var D=this.blendColors(this.frontColor1,this.frontColor2,a[d]);o.strokeStyle="rgb(".concat(D[0],", ").concat(D[1],", ").concat(D[2],")"),o.stroke();break}o.lineTo(r/2+n[I].x*a[d],i/2-n[I].y*a[d])}}}},{key:"finalRotation",value:function(){var e,t=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(this.boundry);try{for(t.s();!(e=t.n()).done;){var n=e.value,o=this.rdt(this.totalX),r=this.rdt(this.totalY),i=this.rdt(this.totalZ),a=n.sy,s=n.sz,l=a*Math.cos(o)+s*Math.sin(o)*-1,c=a*Math.sin(o)+s*Math.cos(o);n.y=l,n.z=c;var u=n.sx;s=n.z;var d=u*Math.cos(r)+s*Math.sin(r)*-1;c=u*Math.sin(r)+s*Math.cos(r),n.x=d,n.z=c,u=n.x,a=n.y,d=u*Math.cos(i)+a*Math.sin(i)*-1,l=u*Math.sin(i)+a*Math.cos(i),n.x=d,n.y=l}}catch(e){t.e(e)}finally{t.f()}}},{key:"turnX",value:function(e){this.totalX+=e,this.totalX%=361,this.totalX<0&&(this.totalX+=360)}},{key:"turnY",value:function(e){this.totalY+=e,this.totalY%=361,this.totalY<0&&(this.totalY+=360)}},{key:"turnZ",value:function(e){this.totalZ+=e,this.totalZ%=361,this.totalZ<0&&(this.totalZ+=360)}},{key:"setRotation",value:function(e){this.totalX=e.x,this.totalY=e.y,this.totalZ=e.z}},{key:"rdt",value:function(e){return e*(Math.PI/180)}},{key:"slerp",value:function(e,t){var n,o=[e.x/this.radius,e.y/this.radius,e.z/this.radius],r=[t.x/this.radius,t.y/this.radius,t.z/this.radius],i=Math.acos(o[0]*r[0]+o[1]*r[1]+o[2]*r[2]);if(Math.abs(i)<1e-6||Math.abs(i-Math.PI)<1e-6)return new v(e.x,e.y,0);n=Math.abs(r[2]-o[2])<1e-6?.5:-o[2]/(r[2]-o[2]);var a=Math.sin((1-n)*i),s=Math.sin(n*i);return new v((a/Math.sin(i)*o[0]+s/Math.sin(i)*r[0])*this.radius,(a/Math.sin(i)*o[1]+s/Math.sin(i)*r[1])*this.radius,0)}},{key:"blendColors",value:function(e,t,n){return[e[0]+(t[0]-e[0])*(n-1)/.5,e[1]+(t[1]-e[1])*(n-1)/.5,e[2]+(t[2]-e[2])*(n-1)/.5]}},{key:"hexToRgb",value:function(e){return[parseInt(e.substring(0,2),16),parseInt(e.substring(2,4),16),parseInt(e.substring(4,6),16)]}},{key:"getRotation",value:function(){return{x:this.totalX,y:this.totalY,z:this.totalZ}}}],n&&w(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function C(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,r=function(e,t){if("object"!==S(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==S(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===S(r)?r:String(r)),o)}var r}var E,k,A,T,O,L,M,P,R,B,z,N,j,F,H,I,D=function(){function e(t,n,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=Math.random()*t,this.y=Math.random()*n,this.size=3*Math.random(),this.angle=2*Math.random()*Math.PI,this.velocity=Math.pow(this.size,2)/4,this.canvasWidth=t,this.canvasHeight=n,this.color=o}var t,n;return t=e,n=[{key:"update",value:function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];t=t/e.length/255*2.5+1,this.x+=this.velocity*t*Math.cos(this.angle),this.y+=this.velocity*t*Math.sin(this.angle),this.angle+=20*Math.random()*Math.PI/180-10*Math.PI/180,this.angle<0&&(this.angle+=Math.PI/12),this.angle>Math.PI&&(this.angle-=Math.PI/12),this.x>this.canvasWidth+15&&(this.x=-5),this.x<-15&&(this.x=this.canvasWidth+5),this.y>this.canvasHeight+15&&(this.y=-5)}},{key:"draw",value:function(e,t){for(var n=0,o=0;o<t.length;o++)n+=t[o];n=n/t.length/255*1.25+1,e.beginPath(),e.arc(this.x,this.y,this.size*n,0,2*Math.PI),e.fillStyle=this.color,e.fill()}}],n&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),V=function(e,t,n,o,r,i,a){j=0,I=i,E=e.getContext("2d"),screen.width>screen.height?e.width=Math.floor(.65*screen.width):e.width=Math.floor(.65*screen.height),e.height=Math.floor(.5*e.width),k=e.width,A=e.height,T=p(E,k,A,a),O=t,L=new Uint8Array(O.fftSize/2),(M=new x(E,r.radius,k,A,(r.rings+1)/2,r.points,o[0],o[1],o[2],o[3])).setRotation(n),N=new Array(1e3);for(var s=0;s<N.length;s++)N[s]=new D(k,A,o[4]);P=(new Date).getTime(),R=0,B=0,z=new Array(128),F=new Array(128),H=new Array(128);for(var l=0;l<z.length;l++)z[l]=0,F[l]=0,H[l]=0},G=function(e){T=p(E,k,A,e)};function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function U(e,t){var n=e.__state.conversionName.toString(),o=Math.round(e.r),r=Math.round(e.g),i=Math.round(e.b),a=e.a,s=Math.round(e.h),l=e.s.toFixed(1),c=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var u=e.hex.toString(16);u.length<6;)u="0"+u;return"#"+u}return"CSS_RGB"===n?"rgb("+o+","+r+","+i+")":"CSS_RGBA"===n?"rgba("+o+","+r+","+i+","+a+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+o+","+r+","+i+"]":"RGBA_ARRAY"===n?"["+o+","+r+","+i+","+a+"]":"RGB_OBJ"===n?"{r:"+o+",g:"+r+",b:"+i+"}":"RGBA_OBJ"===n?"{r:"+o+",g:"+r+",b:"+i+",a:"+a+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+c+",a:"+a+"}":"unknown format"}var X=Array.prototype.forEach,W=Array.prototype.slice,Y={BREAK:{},extend:function(e){return this.each(W.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))}),this),e},defaults:function(e){return this.each(W.call(arguments,1),(function(t){(this.isObject(t)?Object.keys(t):[]).forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))}),this),e},compose:function(){var e=W.call(arguments);return function(){for(var t=W.call(arguments),n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},each:function(e,t,n){if(e)if(X&&e.forEach&&e.forEach===X)e.forEach(t,n);else if(e.length===e.length+0){var o,r=void 0;for(r=0,o=e.length;r<o;r++)if(r in e&&t.call(n,e[r],r)===this.BREAK)return}else for(var i in e)if(t.call(n,e[i],i)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var o=void 0;return function(){var r=this,i=arguments,a=n||!o;clearTimeout(o),o=setTimeout((function(){o=null,n||e.apply(r,i)}),t),a&&e.apply(r,i)}},toArray:function(e){return e.toArray?e.toArray():W.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){return isNaN(e)})),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return e instanceof Function}},J=[{litmus:Y.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:U},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:U},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:U},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*,\s*(\S+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:U}}},{litmus:Y.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:Y.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:Y.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(Y.isNumber(e.r)&&Y.isNumber(e.g)&&Y.isNumber(e.b)&&Y.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(Y.isNumber(e.r)&&Y.isNumber(e.g)&&Y.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(Y.isNumber(e.h)&&Y.isNumber(e.s)&&Y.isNumber(e.v)&&Y.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(Y.isNumber(e.h)&&Y.isNumber(e.s)&&Y.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],K=void 0,Q=void 0,Z=function(){Q=!1;var e=arguments.length>1?Y.toArray(arguments):arguments[0];return Y.each(J,(function(t){if(t.litmus(e))return Y.each(t.conversions,(function(t,n){if(K=t.read(e),!1===Q&&!1!==K)return Q=K,K.conversionName=n,K.conversion=t,Y.BREAK})),Y.BREAK})),Q},$=void 0,ee={hsv_to_rgb:function(e,t,n){var o=Math.floor(e/60)%6,r=e/60-Math.floor(e/60),i=n*(1-t),a=n*(1-r*t),s=n*(1-(1-r)*t),l=[[n,s,i],[a,n,i],[i,n,s],[i,a,n],[s,i,n],[n,i,a]][o];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,n){var o=Math.min(e,t,n),r=Math.max(e,t,n),i=r-o,a=void 0;return 0===r?{h:NaN,s:0,v:0}:(a=e===r?(t-n)/i:t===r?2+(n-e)/i:4+(e-t)/i,(a/=6)<0&&(a+=1),{h:360*a,s:i/r,v:r/255})},rgb_to_hex:function(e,t,n){var o=this.hex_with_component(0,2,e);return o=this.hex_with_component(o,1,t),this.hex_with_component(o,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<($=8*t)|e&~(255<<$)}},te="function"==typeof Symbol&&"symbol"===q(Symbol.iterator)?function(e){return q(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":q(e)},ne=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},oe=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),re=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0},ie=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+q(t));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},ae=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==q(t)&&"function"!=typeof t?e:t},se=function(){function e(){if(ne(this,e),this.__state=Z.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return oe(e,[{key:"toString",value:function(){return U(this)}},{key:"toHexString",value:function(){return U(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),e}();function le(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space||se.recalculateRGB(this,t,n),this.__state[t]},set:function(e){"RGB"!==this.__state.space&&(se.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function ce(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space||se.recalculateHSV(this),this.__state[t]},set:function(e){"HSV"!==this.__state.space&&(se.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}se.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=ee.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");Y.extend(e.__state,ee.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},se.recalculateHSV=function(e){var t=ee.rgb_to_hsv(e.r,e.g,e.b);Y.extend(e.__state,{s:t.s,v:t.v}),Y.isNaN(t.h)?Y.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},se.COMPONENTS=["r","g","b","h","s","v","hex","a"],le(se.prototype,"r",2),le(se.prototype,"g",1),le(se.prototype,"b",0),ce(se.prototype,"h"),ce(se.prototype,"s"),ce(se.prototype,"v"),Object.defineProperty(se.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(se.prototype,"hex",{get:function(){return"HEX"!==this.__state.space&&(this.__state.hex=ee.rgb_to_hex(this.r,this.g,this.b),this.__state.space="HEX"),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var ue=function(){function e(t,n){ne(this,e),this.initialValue=t[n],this.domElement=document.createElement("div"),this.object=t,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return oe(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),de={};Y.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},(function(e,t){Y.each(e,(function(e){de[e]=t}))}));var he=/(\d+(\.\d+)?)px/;function fe(e){if("0"===e||Y.isUndefined(e))return 0;var t=e.match(he);return Y.isNull(t)?0:parseFloat(t[1])}var pe={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var o=n,r=t;Y.isUndefined(r)&&(r=!0),Y.isUndefined(o)&&(o=!0),e.style.position="absolute",r&&(e.style.left=0,e.style.right=0),o&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,o){var r=n||{},i=de[t];if(!i)throw new Error("Event type "+t+" not supported.");var a=document.createEvent(i);switch(i){case"MouseEvents":var s=r.x||r.clientX||0,l=r.y||r.clientY||0;a.initMouseEvent(t,r.bubbles||!1,r.cancelable||!0,window,r.clickCount||1,0,0,s,l,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=a.initKeyboardEvent||a.initKeyEvent;Y.defaults(r,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,r.bubbles||!1,r.cancelable,window,r.ctrlKey,r.altKey,r.shiftKey,r.metaKey,r.keyCode,r.charCode);break;default:a.initEvent(t,r.bubbles||!1,r.cancelable||!0)}Y.defaults(a,o),e.dispatchEvent(a)},bind:function(e,t,n,o){var r=o||!1;return e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n),pe},unbind:function(e,t,n,o){var r=o||!1;return e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent&&e.detachEvent("on"+t,n),pe},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return pe},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),o=n.indexOf(t);-1!==o&&(n.splice(o,1),e.className=n.join(" "))}else e.className=void 0;return pe},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return fe(t["border-left-width"])+fe(t["border-right-width"])+fe(t["padding-left"])+fe(t["padding-right"])+fe(t.width)},getHeight:function(e){var t=getComputedStyle(e);return fe(t["border-top-width"])+fe(t["border-bottom-width"])+fe(t["padding-top"])+fe(t["padding-bottom"])+fe(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent}while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},me=function(e){function t(e,n){ne(this,t);var o=ae(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=o;return o.__prev=o.getValue(),o.__checkbox=document.createElement("input"),o.__checkbox.setAttribute("type","checkbox"),pe.bind(o.__checkbox,"change",(function(){r.setValue(!r.__prev)}),!1),o.domElement.appendChild(o.__checkbox),o.updateDisplay(),o}return ie(t,e),oe(t,[{key:"setValue",value:function(e){var n=re(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),re(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(ue),_e=function(e){function t(e,n,o){ne(this,t);var r=ae(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=o,a=r;if(r.__select=document.createElement("select"),Y.isArray(i)){var s={};Y.each(i,(function(e){s[e]=e})),i=s}return Y.each(i,(function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),a.__select.appendChild(n)})),r.updateDisplay(),pe.bind(r.__select,"change",(function(){var e=this.options[this.selectedIndex].value;a.setValue(e)})),r.domElement.appendChild(r.__select),r}return ie(t,e),oe(t,[{key:"setValue",value:function(e){var n=re(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return pe.isActive(this.__select)?this:(this.__select.value=this.getValue(),re(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(ue),ge=function(e){function t(e,n){ne(this,t);var o=ae(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=o;function i(){r.setValue(r.__input.value)}return o.__input=document.createElement("input"),o.__input.setAttribute("type","text"),pe.bind(o.__input,"keyup",i),pe.bind(o.__input,"change",i),pe.bind(o.__input,"blur",(function(){r.__onFinishChange&&r.__onFinishChange.call(r,r.getValue())})),pe.bind(o.__input,"keydown",(function(e){13===e.keyCode&&this.blur()})),o.updateDisplay(),o.domElement.appendChild(o.__input),o}return ie(t,e),oe(t,[{key:"updateDisplay",value:function(){return pe.isActive(this.__input)||(this.__input.value=this.getValue()),re(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(ue);function ve(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var be=function(e){function t(e,n,o){ne(this,t);var r=ae(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=o||{};return r.__min=i.min,r.__max=i.max,r.__step=i.step,Y.isUndefined(r.__step)?0===r.initialValue?r.__impliedStep=1:r.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(r.initialValue))/Math.LN10))/10:r.__impliedStep=r.__step,r.__precision=ve(r.__impliedStep),r}return ie(t,e),oe(t,[{key:"setValue",value:function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),re(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=ve(e),this}}]),t}(ue),ye=function(e){function t(e,n,o){ne(this,t);var r=ae(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o));r.__truncationSuspended=!1;var i=r,a=void 0;function s(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}function l(e){var t=a-e.clientY;i.setValue(i.getValue()+t*i.__impliedStep),a=e.clientY}function c(){pe.unbind(window,"mousemove",l),pe.unbind(window,"mouseup",c),s()}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),pe.bind(r.__input,"change",(function(){var e=parseFloat(i.__input.value);Y.isNaN(e)||i.setValue(e)})),pe.bind(r.__input,"blur",(function(){s()})),pe.bind(r.__input,"mousedown",(function(e){pe.bind(window,"mousemove",l),pe.bind(window,"mouseup",c),a=e.clientY})),pe.bind(r.__input,"keydown",(function(e){13===e.keyCode&&(i.__truncationSuspended=!0,this.blur(),i.__truncationSuspended=!1,s())})),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return ie(t,e),oe(t,[{key:"updateDisplay",value:function(){var e,n,o;return this.__input.value=this.__truncationSuspended?this.getValue():(e=this.getValue(),n=this.__precision,o=Math.pow(10,n),Math.round(e*o)/o),re(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(be);function we(e,t,n,o,r){return o+(e-t)/(n-t)*(r-o)}var xe=function(e){function t(e,n,o,r,i){ne(this,t);var a=ae(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:o,max:r,step:i})),s=a;function l(e){e.preventDefault();var t=s.__background.getBoundingClientRect();return s.setValue(we(e.clientX,t.left,t.right,s.__min,s.__max)),!1}function c(){pe.unbind(window,"mousemove",l),pe.unbind(window,"mouseup",c),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function u(e){var t=e.touches[0].clientX,n=s.__background.getBoundingClientRect();s.setValue(we(t,n.left,n.right,s.__min,s.__max))}function d(){pe.unbind(window,"touchmove",u),pe.unbind(window,"touchend",d),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return a.__background=document.createElement("div"),a.__foreground=document.createElement("div"),pe.bind(a.__background,"mousedown",(function(e){document.activeElement.blur(),pe.bind(window,"mousemove",l),pe.bind(window,"mouseup",c),l(e)})),pe.bind(a.__background,"touchstart",(function(e){1===e.touches.length&&(pe.bind(window,"touchmove",u),pe.bind(window,"touchend",d),u(e))})),pe.addClass(a.__background,"slider"),pe.addClass(a.__foreground,"slider-fg"),a.updateDisplay(),a.__background.appendChild(a.__foreground),a.domElement.appendChild(a.__background),a}return ie(t,e),oe(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",re(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(be),Se=function(e){function t(e,n,o){ne(this,t);var r=ae(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=r;return r.__button=document.createElement("div"),r.__button.innerHTML=void 0===o?"Fire":o,pe.bind(r.__button,"click",(function(e){return e.preventDefault(),i.fire(),!1})),pe.addClass(r.__button,"button"),r.domElement.appendChild(r.__button),r}return ie(t,e),oe(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(ue),Ce=function(e){function t(e,n){ne(this,t);var o=ae(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));o.__color=new se(o.getValue()),o.__temp=new se(0);var r=o;o.domElement=document.createElement("div"),pe.makeSelectable(o.domElement,!1),o.__selector=document.createElement("div"),o.__selector.className="selector",o.__saturation_field=document.createElement("div"),o.__saturation_field.className="saturation-field",o.__field_knob=document.createElement("div"),o.__field_knob.className="field-knob",o.__field_knob_border="2px solid ",o.__hue_knob=document.createElement("div"),o.__hue_knob.className="hue-knob",o.__hue_field=document.createElement("div"),o.__hue_field.className="hue-field",o.__input=document.createElement("input"),o.__input.type="text",o.__input_textShadow="0 1px 1px ",pe.bind(o.__input,"keydown",(function(e){13===e.keyCode&&d.call(this)})),pe.bind(o.__input,"blur",d),pe.bind(o.__selector,"mousedown",(function(){pe.addClass(this,"drag").bind(window,"mouseup",(function(){pe.removeClass(r.__selector,"drag")}))})),pe.bind(o.__selector,"touchstart",(function(){pe.addClass(this,"drag").bind(window,"touchend",(function(){pe.removeClass(r.__selector,"drag")}))}));var i,a=document.createElement("div");function s(e){f(e),pe.bind(window,"mousemove",f),pe.bind(window,"touchmove",f),pe.bind(window,"mouseup",c),pe.bind(window,"touchend",c)}function l(e){p(e),pe.bind(window,"mousemove",p),pe.bind(window,"touchmove",p),pe.bind(window,"mouseup",u),pe.bind(window,"touchend",u)}function c(){pe.unbind(window,"mousemove",f),pe.unbind(window,"touchmove",f),pe.unbind(window,"mouseup",c),pe.unbind(window,"touchend",c),h()}function u(){pe.unbind(window,"mousemove",p),pe.unbind(window,"touchmove",p),pe.unbind(window,"mouseup",u),pe.unbind(window,"touchend",u),h()}function d(){var e=Z(this.value);!1!==e?(r.__color.__state=e,r.setValue(r.__color.toOriginal())):this.value=r.__color.toString()}function h(){r.__onFinishChange&&r.__onFinishChange.call(r,r.__color.toOriginal())}function f(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=r.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,o=n.clientX,i=n.clientY,a=(o-t.left)/(t.right-t.left),s=1-(i-t.top)/(t.bottom-t.top);return s>1?s=1:s<0&&(s=0),a>1?a=1:a<0&&(a=0),r.__color.v=s,r.__color.s=a,r.setValue(r.__color.toOriginal()),!1}function p(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=r.__hue_field.getBoundingClientRect(),n=1-((e.touches&&e.touches[0]||e).clientY-t.top)/(t.bottom-t.top);return n>1?n=1:n<0&&(n=0),r.__color.h=360*n,r.setValue(r.__color.toOriginal()),!1}return Y.extend(o.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),Y.extend(o.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:o.__field_knob_border+(o.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),Y.extend(o.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),Y.extend(o.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),Y.extend(a.style,{width:"100%",height:"100%",background:"none"}),ke(a,"top","rgba(0,0,0,0)","#000"),Y.extend(o.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),(i=o.__hue_field).style.background="",i.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",i.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",i.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",Y.extend(o.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:o.__input_textShadow+"rgba(0,0,0,0.7)"}),pe.bind(o.__saturation_field,"mousedown",s),pe.bind(o.__saturation_field,"touchstart",s),pe.bind(o.__field_knob,"mousedown",s),pe.bind(o.__field_knob,"touchstart",s),pe.bind(o.__hue_field,"mousedown",l),pe.bind(o.__hue_field,"touchstart",l),o.__saturation_field.appendChild(a),o.__selector.appendChild(o.__field_knob),o.__selector.appendChild(o.__saturation_field),o.__selector.appendChild(o.__hue_field),o.__hue_field.appendChild(o.__hue_knob),o.domElement.appendChild(o.__input),o.domElement.appendChild(o.__selector),o.updateDisplay(),o}return ie(t,e),oe(t,[{key:"updateDisplay",value:function(){var e=Z(this.getValue());if(!1!==e){var t=!1;Y.each(se.COMPONENTS,(function(n){if(!Y.isUndefined(e[n])&&!Y.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}}),this),t&&Y.extend(this.__color.__state,e)}Y.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,o=255-n;Y.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,ke(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),Y.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+o+","+o+","+o+",.7)"})}}]),t}(ue),Ee=["-moz-","-o-","-webkit-","-ms-",""];function ke(e,t,n,o){e.style.background="",Y.each(Ee,(function(r){e.style.cssText+="background: "+r+"linear-gradient("+t+", "+n+" 0%, "+o+" 100%); "}))}var Ae=function(e,t){var n=e[t];return Y.isArray(arguments[2])||Y.isObject(arguments[2])?new _e(e,t,arguments[2]):Y.isNumber(n)?Y.isNumber(arguments[2])&&Y.isNumber(arguments[3])?Y.isNumber(arguments[4])?new xe(e,t,arguments[2],arguments[3],arguments[4]):new xe(e,t,arguments[2],arguments[3]):Y.isNumber(arguments[4])?new ye(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new ye(e,t,{min:arguments[2],max:arguments[3]}):Y.isString(n)?new ge(e,t):Y.isFunction(n)?new Se(e,t,""):Y.isBoolean(n)?new me(e,t):null},Te=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},Oe=function(){function e(){ne(this,e),this.backgroundElement=document.createElement("div"),Y.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),pe.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),Y.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;pe.bind(this.backgroundElement,"click",(function(){t.hide()}))}return oe(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),Y.defer((function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"}))}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",pe.unbind(e.domElement,"webkitTransitionEnd",t),pe.unbind(e.domElement,"transitionend",t),pe.unbind(e.domElement,"oTransitionEnd",t)};pe.bind(this.domElement,"webkitTransitionEnd",t),pe.bind(this.domElement,"transitionend",t),pe.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-pe.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-pe.getHeight(this.domElement)/2+"px"}}]),e}();!function(e,t){var n=t||document,o=document.createElement("style");o.type="text/css",o.innerHTML=e;var r=n.getElementsByTagName("head")[0];try{r.appendChild(o)}catch(e){}}(function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");return t.setAttribute("type","text/css"),t.innerHTML=e,document.head.appendChild(t),e}}(".dg ul{list-style:none;margin:0;padding:0;width:100%;clear:both}.dg.ac{position:fixed;top:0;left:0;right:0;height:0;z-index:0}.dg:not(.ac) .main{overflow:hidden}.dg.main{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear}.dg.main.taller-than-window{overflow-y:auto}.dg.main.taller-than-window .close-button{opacity:1;margin-top:-1px;border-top:1px solid #2c2c2c}.dg.main ul.closed .close-button{opacity:1 !important}.dg.main:hover .close-button,.dg.main .close-button.drag{opacity:1}.dg.main .close-button{-webkit-transition:opacity .1s linear;-o-transition:opacity .1s linear;-moz-transition:opacity .1s linear;transition:opacity .1s linear;border:0;line-height:19px;height:20px;cursor:pointer;text-align:center;background-color:#000}.dg.main .close-button.close-top{position:relative}.dg.main .close-button.close-bottom{position:absolute}.dg.main .close-button:hover{background-color:#111}.dg.a{float:right;margin-right:15px;overflow-y:visible}.dg.a.has-save>ul.close-top{margin-top:0}.dg.a.has-save>ul.close-bottom{margin-top:27px}.dg.a.has-save>ul.closed{margin-top:0}.dg.a .save-row{top:0;z-index:1002}.dg.a .save-row.close-top{position:relative}.dg.a .save-row.close-bottom{position:fixed}.dg li{-webkit-transition:height .1s ease-out;-o-transition:height .1s ease-out;-moz-transition:height .1s ease-out;transition:height .1s ease-out;-webkit-transition:overflow .1s linear;-o-transition:overflow .1s linear;-moz-transition:overflow .1s linear;transition:overflow .1s linear}.dg li:not(.folder){cursor:auto;height:27px;line-height:27px;padding:0 4px 0 5px}.dg li.folder{padding:0;border-left:4px solid rgba(0,0,0,0)}.dg li.title{cursor:pointer;margin-left:-4px}.dg .closed li:not(.title),.dg .closed ul li,.dg .closed ul li>*{height:0;overflow:hidden;border:0}.dg .cr{clear:both;padding-left:3px;height:27px;overflow:hidden}.dg .property-name{cursor:default;float:left;clear:left;width:40%;overflow:hidden;text-overflow:ellipsis}.dg .cr.function .property-name{width:100%}.dg .c{float:left;width:60%;position:relative}.dg .c input[type=text]{border:0;margin-top:4px;padding:3px;width:100%;float:right}.dg .has-slider input[type=text]{width:30%;margin-left:0}.dg .slider{float:left;width:66%;margin-left:-5px;margin-right:0;height:19px;margin-top:4px}.dg .slider-fg{height:100%}.dg .c input[type=checkbox]{margin-top:7px}.dg .c select{margin-top:5px}.dg .cr.function,.dg .cr.function .property-name,.dg .cr.function *,.dg .cr.boolean,.dg .cr.boolean *{cursor:pointer}.dg .cr.color{overflow:visible}.dg .selector{display:none;position:absolute;margin-left:-9px;margin-top:23px;z-index:10}.dg .c:hover .selector,.dg .selector.drag{display:block}.dg li.save-row{padding:0}.dg li.save-row .button{display:inline-block;padding:0px 6px}.dg.dialogue{background-color:#222;width:460px;padding:15px;font-size:13px;line-height:15px}#dg-new-constructor{padding:10px;color:#222;font-family:Monaco, monospace;font-size:10px;border:0;resize:none;box-shadow:inset 1px 1px 1px #888;word-wrap:break-word;margin:12px 0;display:block;width:440px;overflow-y:scroll;height:100px;position:relative}#dg-local-explain{display:none;font-size:11px;line-height:17px;border-radius:3px;background-color:#333;padding:8px;margin-top:10px}#dg-local-explain code{font-size:10px}#dat-gui-save-locally{display:none}.dg{color:#eee;font:11px 'Lucida Grande', sans-serif;text-shadow:0 -1px 0 #111}.dg.main::-webkit-scrollbar{width:5px;background:#1a1a1a}.dg.main::-webkit-scrollbar-corner{height:0;display:none}.dg.main::-webkit-scrollbar-thumb{border-radius:5px;background:#676767}.dg li:not(.folder){background:#1a1a1a;border-bottom:1px solid #2c2c2c}.dg li.save-row{line-height:25px;background:#dad5cb;border:0}.dg li.save-row select{margin-left:5px;width:108px}.dg li.save-row .button{margin-left:5px;margin-top:1px;border-radius:2px;font-size:9px;line-height:7px;padding:4px 4px 5px 4px;background:#c5bdad;color:#fff;text-shadow:0 1px 0 #b0a58f;box-shadow:0 -1px 0 #b0a58f;cursor:pointer}.dg li.save-row .button.gears{background:#c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;height:7px;width:8px}.dg li.save-row .button:hover{background-color:#bab19e;box-shadow:0 -1px 0 #b0a58f}.dg li.folder{border-bottom:0}.dg li.title{padding-left:16px;background:#000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;cursor:pointer;border-bottom:1px solid rgba(255,255,255,0.2)}.dg .closed li.title{background-image:url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)}.dg .cr.boolean{border-left:3px solid #806787}.dg .cr.color{border-left:3px solid}.dg .cr.function{border-left:3px solid #e61d5f}.dg .cr.number{border-left:3px solid #2FA1D6}.dg .cr.number input[type=text]{color:#2FA1D6}.dg .cr.string{border-left:3px solid #1ed36f}.dg .cr.string input[type=text]{color:#1ed36f}.dg .cr.function:hover,.dg .cr.boolean:hover{background:#111}.dg .c input[type=text]{background:#303030;outline:none}.dg .c input[type=text]:hover{background:#3c3c3c}.dg .c input[type=text]:focus{background:#494949;color:#fff}.dg .c .slider{background:#303030;cursor:ew-resize}.dg .c .slider-fg{background:#2FA1D6;max-width:100%}.dg .c .slider:hover{background:#3c3c3c}.dg .c .slider:hover .slider-fg{background:#44abda}\n"));var Le="Default",Me=function(){try{return!!window.localStorage}catch(e){return!1}}(),Pe=void 0,Re=!0,Be=void 0,ze=!1,Ne=[],je=function e(t){var n=this,o=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),pe.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],o=Y.defaults(o,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),o=Y.defaults(o,{resizable:o.autoPlace,hideable:o.autoPlace}),Y.isUndefined(o.load)?o.load={preset:Le}:o.preset&&(o.load.preset=o.preset),Y.isUndefined(o.parent)&&o.hideable&&Ne.push(this),o.resizable=Y.isUndefined(o.parent)&&o.resizable,o.autoPlace&&Y.isUndefined(o.scrollable)&&(o.scrollable=!0);var r,i=Me&&"true"===localStorage.getItem(Ge(0,"isLocal")),a=void 0,s=void 0;if(Object.defineProperties(this,{parent:{get:function(){return o.parent}},scrollable:{get:function(){return o.scrollable}},autoPlace:{get:function(){return o.autoPlace}},closeOnTop:{get:function(){return o.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:o.load.preset},set:function(e){n.parent?n.getRoot().preset=e:o.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),n.revert()}},width:{get:function(){return o.width},set:function(e){o.width=e,We(n,e)}},name:{get:function(){return o.name},set:function(e){o.name=e,s&&(s.innerHTML=o.name)}},closed:{get:function(){return o.closed},set:function(t){o.closed=t,o.closed?pe.addClass(n.__ul,e.CLASS_CLOSED):pe.removeClass(n.__ul,e.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return o.load}},useLocalStorage:{get:function(){return i},set:function(e){Me&&(i=e,e?pe.bind(window,"unload",a):pe.unbind(window,"unload",a),localStorage.setItem(Ge(0,"isLocal"),e))}}}),Y.isUndefined(o.parent)){if(this.closed=o.closed||!1,pe.addClass(this.domElement,e.CLASS_MAIN),pe.makeSelectable(this.domElement,!1),Me&&i){n.useLocalStorage=!0;var l=localStorage.getItem(Ge(0,"gui"));l&&(o.load=JSON.parse(l))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,pe.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),o.closeOnTop?(pe.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(pe.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),pe.bind(this.__closeButton,"click",(function(){n.closed=!n.closed}))}else{void 0===o.closed&&(o.closed=!0);var c=document.createTextNode(o.name);pe.addClass(c,"controller-name"),s=Fe(n,c),pe.addClass(this.__ul,e.CLASS_CLOSED),pe.addClass(s,"title"),pe.bind(s,"click",(function(e){return e.preventDefault(),n.closed=!n.closed,!1})),o.closed||(this.closed=!1)}o.autoPlace&&(Y.isUndefined(o.parent)&&(Re&&(Be=document.createElement("div"),pe.addClass(Be,"dg"),pe.addClass(Be,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(Be),Re=!1),Be.appendChild(this.domElement),pe.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||We(n,o.width)),this.__resizeHandler=function(){n.onResizeDebounced()},pe.bind(window,"resize",this.__resizeHandler),pe.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),pe.bind(this.__ul,"transitionend",this.__resizeHandler),pe.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),o.resizable&&Xe(this),a=function(){Me&&"true"===localStorage.getItem(Ge(0,"isLocal"))&&localStorage.setItem(Ge(0,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=a,o.parent||((r=n.getRoot()).width+=1,Y.defer((function(){r.width-=1})))};function Fe(e,t,n){var o=document.createElement("li");return t&&o.appendChild(t),n?e.__ul.insertBefore(o,n):e.__ul.appendChild(o),e.onResize(),o}function He(e){pe.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&pe.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function Ie(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function De(e,t){var n=e.getRoot(),o=n.__rememberedObjects.indexOf(t.object);if(-1!==o){var r=n.__rememberedObjectIndecesToControllers[o];if(void 0===r&&(r={},n.__rememberedObjectIndecesToControllers[o]=r),r[t.property]=t,n.load&&n.load.remembered){var i=n.load.remembered,a=void 0;if(i[e.preset])a=i[e.preset];else{if(!i[Le])return;a=i[Le]}if(a[o]&&void 0!==a[o][t.property]){var s=a[o][t.property];t.initialValue=s,t.setValue(s)}}}}function Ve(e,t,n,o){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var r=void 0;if(o.color)r=new Ce(t,n);else{var i=[t,n].concat(o.factoryArgs);r=Ae.apply(e,i)}o.before instanceof ue&&(o.before=o.before.__li),De(e,r),pe.addClass(r.domElement,"c");var a=document.createElement("span");pe.addClass(a,"property-name"),a.innerHTML=r.property;var s=document.createElement("div");s.appendChild(a),s.appendChild(r.domElement);var l=Fe(e,s,o.before);return pe.addClass(l,je.CLASS_CONTROLLER_ROW),r instanceof Ce?pe.addClass(l,"color"):pe.addClass(l,te(r.getValue())),function(e,t,n){if(n.__li=t,n.__gui=e,Y.extend(n,{options:function(t){if(arguments.length>1){var o=n.__li.nextElementSibling;return n.remove(),Ve(e,n.object,n.property,{before:o,factoryArgs:[Y.toArray(arguments)]})}if(Y.isArray(t)||Y.isObject(t)){var r=n.__li.nextElementSibling;return n.remove(),Ve(e,n.object,n.property,{before:r,factoryArgs:[t]})}},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof xe){var o=new ye(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});Y.each(["updateDisplay","onChange","onFinishChange","step","min","max"],(function(e){var t=n[e],r=o[e];n[e]=o[e]=function(){var e=Array.prototype.slice.call(arguments);return r.apply(o,e),t.apply(n,e)}})),pe.addClass(t,"has-slider"),n.domElement.insertBefore(o.domElement,n.domElement.firstElementChild)}else if(n instanceof ye){var r=function(t){if(Y.isNumber(n.__min)&&Y.isNumber(n.__max)){var o=n.__li.firstElementChild.firstElementChild.innerHTML,r=n.__gui.__listening.indexOf(n)>-1;n.remove();var i=Ve(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return i.name(o),r&&i.listen(),i}return t};n.min=Y.compose(r,n.min),n.max=Y.compose(r,n.max)}else n instanceof me?(pe.bind(t,"click",(function(){pe.fakeEvent(n.__checkbox,"click")})),pe.bind(n.__checkbox,"click",(function(e){e.stopPropagation()}))):n instanceof Se?(pe.bind(t,"click",(function(){pe.fakeEvent(n.__button,"click")})),pe.bind(t,"mouseover",(function(){pe.addClass(n.__button,"hover")})),pe.bind(t,"mouseout",(function(){pe.removeClass(n.__button,"hover")}))):n instanceof Ce&&(pe.addClass(t,"color"),n.updateDisplay=Y.compose((function(e){return t.style.borderLeftColor=n.__color.toString(),e}),n.updateDisplay),n.updateDisplay());n.setValue=Y.compose((function(t){return e.getRoot().__preset_select&&n.isModified()&&Ie(e.getRoot(),!0),t}),n.setValue)}(e,l,r),e.__controllers.push(r),r}function Ge(e,t){return document.location.href+"."+t}function qe(e,t,n){var o=document.createElement("option");o.innerHTML=t,o.value=t,e.__preset_select.appendChild(o),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function Ue(e,t){t.style.display=e.useLocalStorage?"block":"none"}function Xe(e){var t=void 0;function n(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function o(){pe.removeClass(e.__closeButton,je.CLASS_DRAG),pe.unbind(window,"mousemove",n),pe.unbind(window,"mouseup",o)}function r(r){return r.preventDefault(),t=r.clientX,pe.addClass(e.__closeButton,je.CLASS_DRAG),pe.bind(window,"mousemove",n),pe.bind(window,"mouseup",o),!1}e.__resize_handle=document.createElement("div"),Y.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),pe.bind(e.__resize_handle,"mousedown",r),pe.bind(e.__closeButton,"mousedown",r),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function We(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function Ye(e,t){var n={};return Y.each(e.__rememberedObjects,(function(o,r){var i={},a=e.__rememberedObjectIndecesToControllers[r];Y.each(a,(function(e,n){i[n]=t?e.initialValue:e.getValue()})),n[r]=i})),n}function Je(e){0!==e.length&&Te.call(window,(function(){Je(e)})),Y.each(e,(function(e){e.updateDisplay()}))}je.toggleHide=function(){ze=!ze,Y.each(Ne,(function(e){e.domElement.style.display=ze?"none":""}))},je.CLASS_AUTO_PLACE="a",je.CLASS_AUTO_PLACE_CONTAINER="ac",je.CLASS_MAIN="main",je.CLASS_CONTROLLER_ROW="cr",je.CLASS_TOO_TALL="taller-than-window",je.CLASS_CLOSED="closed",je.CLASS_CLOSE_BUTTON="close-button",je.CLASS_CLOSE_TOP="close-top",je.CLASS_CLOSE_BOTTOM="close-bottom",je.CLASS_DRAG="drag",je.DEFAULT_WIDTH=245,je.TEXT_CLOSED="Close Controls",je.TEXT_OPEN="Open Controls",je._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||je.toggleHide()},pe.bind(window,"keydown",je._keydownHandler,!1),Y.extend(je.prototype,{add:function(e,t){return Ve(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Ve(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;Y.defer((function(){t.onResize()}))},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&Be.removeChild(this.domElement);var e=this;Y.each(this.__folders,(function(t){e.removeFolder(t)})),pe.unbind(window,"keydown",je._keydownHandler,!1),He(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new je(t);this.__folders[e]=n;var o=Fe(this,n.domElement);return pe.addClass(o,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],He(e);var t=this;Y.each(e.__folders,(function(t){e.removeFolder(t)})),Y.defer((function(){t.onResize()}))},open:function(){this.closed=!1},close:function(){this.closed=!0},hide:function(){this.domElement.style.display="none"},show:function(){this.domElement.style.display=""},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=pe.getOffset(e.__ul).top,n=0;Y.each(e.__ul.childNodes,(function(t){e.autoPlace&&t===e.__save_row||(n+=pe.getHeight(t))})),window.innerHeight-t-20<n?(pe.addClass(e.domElement,je.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(pe.removeClass(e.domElement,je.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&Y.defer((function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"})),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:Y.debounce((function(){this.onResize()}),50),remember:function(){if(Y.isUndefined(Pe)&&((Pe=new Oe).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;Y.each(Array.prototype.slice.call(arguments),(function(t){0===e.__rememberedObjects.length&&function(e){var t=e.__save_row=document.createElement("li");pe.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),pe.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",pe.addClass(n,"button gears");var o=document.createElement("span");o.innerHTML="Save",pe.addClass(o,"button"),pe.addClass(o,"save");var r=document.createElement("span");r.innerHTML="New",pe.addClass(r,"button"),pe.addClass(r,"save-as");var i=document.createElement("span");i.innerHTML="Revert",pe.addClass(i,"button"),pe.addClass(i,"revert");var a=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?Y.each(e.load.remembered,(function(t,n){qe(e,n,n===e.preset)})):qe(e,Le,!1),pe.bind(a,"change",(function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value})),t.appendChild(a),t.appendChild(n),t.appendChild(o),t.appendChild(r),t.appendChild(i),Me){var s=document.getElementById("dg-local-explain"),l=document.getElementById("dg-local-storage");document.getElementById("dg-save-locally").style.display="block","true"===localStorage.getItem(Ge(0,"isLocal"))&&l.setAttribute("checked","checked"),Ue(e,s),pe.bind(l,"change",(function(){e.useLocalStorage=!e.useLocalStorage,Ue(e,s)}))}var c=document.getElementById("dg-new-constructor");pe.bind(c,"keydown",(function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||Pe.hide()})),pe.bind(n,"click",(function(){c.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),Pe.show(),c.focus(),c.select()})),pe.bind(o,"click",(function(){e.save()})),pe.bind(r,"click",(function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)})),pe.bind(i,"click",(function(){e.revert()}))}(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)})),this.autoPlace&&We(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=Ye(this)),e.folders={},Y.each(this.__folders,(function(t,n){e.folders[n]=t.getSaveObject()})),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=Ye(this),Ie(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[Le]=Ye(this,!0)),this.load.remembered[e]=Ye(this),this.preset=e,qe(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){Y.each(this.__controllers,(function(t){this.getRoot().load.remembered?De(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())}),this),Y.each(this.__folders,(function(e){e.revert(e)})),e||Ie(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&Je(this.__listening)},updateDisplay:function(){Y.each(this.__controllers,(function(e){e.updateDisplay()})),Y.each(this.__folders,(function(e){e.updateDisplay()}))}});const Ke=je;function Qe(e){return Qe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qe(e)}function Ze(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==Qe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==Qe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"===Qe(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $e(){$e=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function c(e,t,n,r){var i=t&&t.prototype instanceof h?t:h,a=Object.create(i.prototype),s=new E(r||[]);return o(a,"_invoke",{value:w(e,n,s)}),a}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var d={};function h(){}function f(){}function p(){}var m={};l(m,i,(function(){return this}));var _=Object.getPrototypeOf,g=_&&_(_(k([])));g&&g!==t&&n.call(g,i)&&(m=g);var v=p.prototype=h.prototype=Object.create(m);function b(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function y(e,t){function r(o,i,a,s){var l=u(e[o],e,i);if("throw"!==l.type){var c=l.arg,d=c.value;return d&&"object"==Qe(d)&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){c.value=e,a(c)}),(function(e){return r("throw",e,a,s)}))}s(l.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,o){r(e,n,t,o)}))}return i=i?i.then(o,o):o()}})}function w(e,t,n){var o="suspendedStart";return function(r,i){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===r)throw i;return{value:void 0,done:!0}}for(n.method=r,n.arg=i;;){var a=n.delegate;if(a){var s=x(a,n);if(s){if(s===d)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===o)throw o="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o="executing";var l=u(e,t,n);if("normal"===l.type){if(o=n.done?"completed":"suspendedYield",l.arg===d)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o="completed",n.method="throw",n.arg=l.arg)}}}function x(e,t){var n=t.method,o=e.iterator[n];if(void 0===o)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,x(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),d;var r=u(o,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,d;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function k(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,r=function t(){for(;++o<e.length;)if(n.call(e,o))return t.value=e[o],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:A}}function A(){return{value:void 0,done:!0}}return f.prototype=p,o(v,"constructor",{value:p,configurable:!0}),o(p,"constructor",{value:f,configurable:!0}),f.displayName=l(p,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,l(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},b(y.prototype),l(y.prototype,a,(function(){return this})),e.AsyncIterator=y,e.async=function(t,n,o,r,i){void 0===i&&(i=Promise);var a=new y(c(t,n,o,r),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},b(v),l(v,s,"Generator"),l(v,i,(function(){return this})),l(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var o in t)n.push(o);return n.reverse(),function e(){for(;n.length;){var o=n.pop();if(o in t)return e.value=o,e.done=!1,e}return e.done=!0,e}},e.values=k,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function o(n,o){return a.type="throw",a.arg=e,t.next=n,o&&(t.method="next",t.arg=void 0),!!o}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],a=i.completion;if("root"===i.tryLoc)return o("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),l=n.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return o(i.catchLoc,!0);if(this.prev<i.finallyLoc)return o(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return o(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return o(i.finallyLoc)}}}},abrupt:function(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o];if(r.tryLoc<=this.prev&&n.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var o=n.completion;if("throw"===o.type){var r=o.arg;C(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:k(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),d}},e}function et(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tt(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function tt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function nt(e,t,n,o,r,i,a){try{var s=e[i](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(o,r)}var ot={},rt=!1,it=new Stats;it.showPanel(0);var at,st,lt,ct,ut,dt={},ht={},ft={},pt={},mt={},_t=[],gt=0,vt=function(){var e,t=(e=$e().mark((function e(){var t,n,o,i,a,s,l,u,d,f,p,m;return $e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.querySelector("#my-stats-container").appendChild(it.dom),ut=document.querySelector("#update-message"),t=document.querySelector("canvas"),n="./data/av-data.json",null===localStorage.getItem("dpsAudio")){e.next=42;break}if(ut.innerHTML="Loading Songs...",o=JSON.parse(localStorage.getItem("dpsAudio")),i=o.drawParams,Object.assign(ht,i),a=o.Rotation,Object.assign(dt,a),(s=document.createElement("h1")).textContent=o.Title,lt=o.Colors,ft=o.SphereOptions,gt=o.Volume,mt=o.Biquads,st=o.NumParticles,ot=o.GradientData,document.body.insertBefore(s,document.body.firstChild),l=document.getElementById("track-select"),u=[],!(o.Songs.length>0)){e.next=39;break}d=et(o.Songs),e.prev=24,p=$e().mark((function e(){var t;return $e().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=f.value,e.t0=u,e.next=4,fetch(t.location).then((function(e){return e.blob()})).then((function(e){var n=URL.createObjectURL(e);l.insertAdjacentHTML("beforeend",'<option value="'.concat(n,'">').concat(t.title,"</option>")),_t.push(t.location)}));case 4:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 6:case"end":return e.stop()}}),e)})),d.s();case 27:if((f=d.n()).done){e.next=31;break}return e.delegateYield(p(),"t0",29);case 29:e.next=27;break;case 31:e.next=36;break;case 33:e.prev=33,e.t1=e.catch(24),d.e(e.t1);case 36:return e.prev=36,d.f(),e.finish(36);case 39:Promise.all(u).then((function(){ut.innerHTML="",c("".concat(_t[0])),h(ht.loopAudio),V(t,r,dt,lt,ft,st,ot),bt(t),requestAnimationFrame(xt)})),e.next=44;break;case 42:m=document.getElementById("track-select"),fetch(n).then((function(e){return e.json()})).then((function(e){var n,o=et(e.Songs);try{for(o.s();!(n=o.n()).done;){var i=n.value;_t.push(i.location),m.insertAdjacentHTML("beforeend",'<option value="'.concat(i.location,'">').concat(i.title,"</option>"))}}catch(e){o.e(e)}finally{o.f()}c("./".concat(_t[0]));var a=e.drawParams;Object.assign(ht,a);var s=e.Rotation;Object.assign(dt,s);var l=document.createElement("h1");l.textContent=e.Title,lt=e.Colors,ft=e.SphereOptions,gt=e.Volume,mt=e.Biquads,st=e.NumParticles,ot=e.GradientData,document.body.insertBefore(l,document.body.firstChild),V(t,r,dt,lt,ft,st,ot),bt(t),requestAnimationFrame(xt)}));case 44:case"end":return e.stop()}}),e,null,[[24,33,36,39]])})),function(){var t=this,n=arguments;return new Promise((function(o,r){var i=e.apply(t,n);function a(e){nt(i,o,r,a,s,"next",e)}function s(e){nt(i,o,r,a,s,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}(),bt=function(e){var o=screen.width-k-125;o<400&&(o=400),document.querySelector("#removal").onclick=function(){for(var e=document.querySelector("#track-select"),t=0;t<e.children.length;t++)if(e.children[t].value===e.value){e.remove(t),_t.splice(t,1);var n=document.querySelector("#play-button");"yes"==n.dataset.playing&&(n.dataset.playing="no"),0==e.children.length?u("NaN"):u(_t[0]);break}St()};var r=new Ke({width:o}),l=document.querySelector("#play-button");l.onclick=function(e){var o;"suspended"==t.state&&t.resume(),"no"==e.target.dataset.playing?(o=i.gain.value,n.play().catch((function(e){var t=document.querySelector("#update-message");0==document.querySelector("#track-select").children.length?t.innerHTML="No available tracks.":t.innerHTML="Track was removed after server update. Please reupload."})),i.gain.value=o,e.target.dataset.playing="yes"):(n.pause(),e.target.dataset.playing="no")};var c=r.addFolder("Sound"),f=c.add({volOption:gt},"volOption",0,100);d(gt/100),f.onChange((function(e){d(e/100),gt=e,St()})),f.name("Volume");var p=c.add(ht,"useTreble");p.onChange((function(e){1==e?(a.frequency.setValueAtTime(mt.trebFreq,t.currentTime),a.gain.setValueAtTime(mt.trebGain,t.currentTime)):a.gain.setValueAtTime(0,t.currentTime),St()})),p.name("Treble Boost"),1==ht.useTreble&&(a.frequency.setValueAtTime(mt.trebFreq,t.currentTime),a.gain.setValueAtTime(mt.trebGain,t.currentTime));var m=c.add(ht,"useBase");m.onChange((function(e){1==e?(s.frequency.setValueAtTime(mt.bassFreq,t.currentTime),s.gain.setValueAtTime(mt.bassGain,t.currentTime)):s.gain.setValueAtTime(0,t.currentTime),St()})),m.name("Bass Boost"),1==ht.useBase&&(s.frequency.setValueAtTime(mt.bassFreq,t.currentTime),s.gain.setValueAtTime(mt.bassGain,t.currentTime));var _=c.addFolder("Boost Options"),g=_.add(mt,"trebFreq",10,24e3).name("Treble Frequency");g.onChange((function(e){a.frequency.setValueAtTime(mt.trebFreq,t.currentTime),St()}));var v=g.domElement.parentNode.querySelector(".property-name");v.classList.add("tooltip");var b=document.createElement("span");b.classList.add("tooltiptext"),b.innerHTML="Gray Area",v.appendChild(b),_.add(mt,"trebGain",0,50).name("Treble Gain").onChange((function(e){1==ht.useTreble&&a.gain.setValueAtTime(mt.trebGain,t.currentTime),St()}));var y=_.add(mt,"bassFreq",10,24e3).name("Bass Frequency");y.onChange((function(e){s.frequency.setValueAtTime(mt.bassFreq,t.currentTime),St()})),(v=y.domElement.parentNode.querySelector(".property-name")).classList.add("tooltip"),(b=document.createElement("span")).classList.add("tooltiptext"),b.innerHTML="Blue Area",v.appendChild(b),_.add(mt,"bassGain",0,50).name("Bass Gain").onChange((function(e){1==ht.useBase&&s.gain.setValueAtTime(mt.bassGain,t.currentTime),St()})),c.open(),document.querySelector("#track-select").onchange=function(e){ut.innerHTML="",u(e.target.value),h(oe.checked),"yes"==l.dataset.playing&&l.dispatchEvent(new MouseEvent("click"))};var w=document.querySelector("#music-file");w.value="",w.onchange=function(e){e.preventDefault();var t=e.target.files[0],n=new FormData;n.append("file",t),ut.innerHTML="Loading Song...",fetch("https://sphericalaudio-4a79e7796729.herokuapp.com/upload",{method:"POST",body:n}).then((function(e){return e.text()})).then((function(e){ut.innerHTML="";var t=e.split("/").pop(),n="https://sphericalaudio-4a79e7796729.herokuapp.com/uploads/".concat(t);for(t=(t=t.substring(0,t.lastIndexOf("."))).replace("_"," ");t.includes("_");)t=t.replace("_"," ");for(;t.includes("-");)t=t.replace("-"," ");"yes"==l.dataset.playing&&l.dispatchEvent(new MouseEvent("click"));var o=document.getElementById("track-select"),r=Array.from(o.options).find((function(e){return e.textContent===t}));r?(r.selected=!0,u(n),h(oe.checked)):((r=document.createElement("option")).value=n,r.textContent=t,_t.push(n),r.selected=!0,o.appendChild(r),u(r.value),h(oe.checked),St())})).catch((function(e){console.error(e)}))};var S=r.addFolder("Sphere"),C=S.add(ht,"showSphere");C.name("Display Sphere"),C.onChange((function(e){St()}));var T=S.add(ht,"pulseSphere");T.name("Pulse"),T.onChange((function(e){St()}));var O=S.add(ht,"spinSphere");O.name("Spin"),O.onChange((function(e){St()}));var L=(at=S.addFolder("Rotation")).add(dt,"x",0,360),P=at.add(dt,"y",0,360),R=at.add(dt,"z",0,360);L.onChange((function(e){M.setRotation(dt),St()})),P.onChange((function(e){M.setRotation(dt),St()})),R.onChange((function(e){M.setRotation(dt),St()}));var B=S.addFolder("Build Options");ct=lt,pt=ft,B.add(pt,"radius",50,300).name("Radius");var z=B.add(pt,"rings",1,45).name("Rings").step(2);z.onChange((function(e){e%2==0&&(e-=1,pt.rings=e,z.updateDisplay())})),(v=B.add(pt,"points",3,1e3).name("Points").step(1).domElement.parentNode.querySelector(".property-name")).classList.add("tooltip"),(b=document.createElement("span")).classList.add("tooltiptext"),b.innerHTML="Per Ring: May Cause Lag",v.appendChild(b),B.addColor(ct,0).name("Front Primary"),B.addColor(ct,1).name("Front Secondary"),B.addColor(ct,2).name("Back Primary"),B.addColor(ct,3).name("Back Secondary");var j={reBuild:function(){(function(e,t,n){(M=new x(E,e.radius,k,A,(e.rings+1)/2,e.points,t[0],t[1],t[2],t[3])).setRotation(n)})(ft=pt,lt=ct,dt),St()}};B.add(j,"reBuild").name("Build Sphere"),S.open();var F=r.addFolder("Background"),H=F.add(ht,"showBars");H.name("Display Bars"),H.onChange((function(e){St()}));var D=F.add(ht,"showGradient");D.name("Display Gradient"),D.onChange((function(e){St()}));var V=F.add(ht,"showConfetti");V.name("Display Particles"),V.onChange((function(e){St()}));var q=F.addFolder("Specialized Options");q.add(ht,"displayWaveform").name("Display Waveform").onChange((function(e){ht.displayFrequency=!ht.displayWaveform,St()})),q.add({number:st},"number",1,1e3).name("# of Particles").step(1).onChange((function(e){I=e,st=e,St()})),q.addColor(ct,4).name("Particle Color").onChange((function(e){!function(e){for(var t=0;t<N.length;t++)N[t].color=e}(e),St()}));var U=q.addFolder("Gradient");U.add(ot,"angle",0,360).name("Angle").onChange((function(e){G(ot),St()}));var X=U.add({addColorStop:function(){var e={percent:.5,color:"#ffffff"};ot.colorStops.push(e);var t=ot.colorStops.length-1,n=U.addColor(e,"color");n.name("Color ".concat(t+1)),n.property="color",n.onChange((function(e){G(ot),St()}));var o,r=U.add(e,"percent",0,1);r.name("Percent"),r.property="percent",r.onChange((function(e){G(ot),St()})),G(ot),St(),U.add(Ze({},"remove".concat(t+1),(o=t,function(){W(o),G(ot),St()})),"remove".concat(t+1)).name("Remove Color Stop ".concat(t+1))}},"addColorStop").name("Add Color Stop");X.domElement.parentNode.parentNode.classList.add("add-button");for(var W=function e(t){ot.colorStops.splice(t,1);var n=U.__controllers[3*t+2],o=U.__controllers[3*t+3],r=U.__controllers.find((function(e){return e.property==="remove".concat(t+1)}));U.remove(n),U.remove(o),U.remove(r);for(var i=function(t){var n=U.__controllers[3*t+2],o=U.__controllers.find((function(e){return e.property==="remove".concat(t+2)}));n.name("Color ".concat(t+1)),o.name("Remove Color Stop ".concat(t+1)),o.property="remove".concat(t+1),o.object["remove".concat(t+1)]=function(t){return function(){e(t),G(ot),St()}}(t),delete o.object["remove".concat(t+2)]},a=t;a<ot.colorStops.length;a++)i(a)},Y=0;Y<ot.colorStops.length;Y++){var J=ot.colorStops[Y],K=U.addColor(J,"color");K.name("Color ".concat(Y+1)),K.property="color",K.onChange((function(e){G(ot),St()}));var Q=U.add(J,"percent",0,1);Q.name("Percent"),Q.property="percent",Q.onChange((function(e){G(ot),St()})),U.add(Ze({},"remove".concat(Y+1),function(e){return function(){W(e),G(ot),St()}}(Y)),"remove".concat(Y+1)).name("Remove Color Stop ".concat(Y+1))}var Z=r.addFolder("Overlay"),$=Z.add(ht,"showEmboss");$.name("Emboss"),Z.open(),(v=$.domElement.parentNode.querySelector(".property-name")).classList.add("tooltip"),(b=document.createElement("span")).classList.add("tooltiptext"),b.innerHTML="Warning: This Will Cause Lag",v.appendChild(b),$.onChange((function(e){St()}));var ee=Z.add(ht,"showInvert");ee.name("Invert"),ee.onChange((function(e){St()}));var te=Z.add(ht,"showNoise");te.name("Noise"),te.onChange((function(e){St()}));var ne={reset:function(){rt=!0,localStorage.removeItem("dpsAudio"),location.reload()}};r.add(ne,"reset").name("Revert to Default Settings");var oe=document.querySelector("#loop-cb");ht.loopAudio?oe.checked=!0:oe.checked=!1,oe.onchange=function(){ht.loopAudio=oe.checked,h(oe.checked),St()}},yt=1e3/60,wt=performance.now(),xt=function e(t){var n=t-wt;if(n>yt){if(wt=t-n%yt,it.begin(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(R=(new Date).getTime(),B=(R-P)/1e3,e.displayWaveform&&(j+=B),O.getByteFrequencyData(L),z=L,E.save(),E.fillStyle="black",E.globalAlpha=1,E.fillRect(0,0,k,A),E.restore(),e.showGradient&&(E.save(),E.fillStyle=T,E.globalAlpha=1,E.fillRect(0,0,k,A),E.restore()),e.displayWaveform&&j>.03333){j-=.03333,O.getByteTimeDomainData(L);for(var t=0;t<F.length;t++)H[t]=(L[t]+H[t])/2,F[t]=H[t];z=F}else if(e.displayWaveform){O.getByteTimeDomainData(L);for(var n=0;n<F.length;n++)H[n]=(L[n]+H[n])/2;z=F}if(e.showBars){E.save();for(var o=O.frequencyBinCount,r=k/128-.5,i=0,a=0,s=0;s<o;s++)i=z[s]*(.002*A),E.fillStyle="rgba(255, 255, 255, 0.5)",E.fillRect(a,A/2-i+i/2,r,i),a+=r+.5,E.restore()}if(e.displayWaveform&&(O.getByteFrequencyData(L),z=L),e.showConfetti)for(var l=0;l<I;l++)N[l].update(z),N[l].draw(E,z);if(e.showSphere){if(E.save(),e.pulseSphere?M.drawSphere(z,!0):M.drawSphere(z,!1),e.spinSphere){for(var c=0,u=0,d=0,h=0;h<43;h++)c+=z[h];for(var f=43;f<85;f++)u+=z[f];for(var p=86;p<128;p++)d+=z[p];0!=c&&(c=(c-128)/44),0!=u&&(u=(u-90)/43),0!=d&&(d=(d-50)/43),M.turnX(c*B),M.turnY(u*B),M.turnZ(d*B)}E.restore()}for(var m=E.getImageData(0,0,k,A),_=m.data,g=_.length,v=m.width,b=0;b<g;b+=4)if(e.showNoise&&Math.random()<.05&&(_[b]=_[b+1]=_[b+2]=0),e.showInvert){var y=_[b],w=_[b+1],x=_[b+2];_[b]=255-y,_[b+1]=255-w,_[b+2]=255-x}if(e.showEmboss)for(var S=0;S<g;S++)S%4!=3&&(_[S]=127+2*_[S]-_[S+4]-_[S+4*v]);E.putImageData(m,0,0),P=R}(ht),ht.spinSphere&&!rt){var o=M.getRotation();dt.x=o.x,dt.y=o.y,dt.z=o.z,at.updateDisplay(),St()}it.end()}requestAnimationFrame(e)},St=function(){for(var e=document.querySelector("#track-select"),t=[],n=0;n<e.children.length;n++){var o={title:e.children[n].textContent,location:_t[n]};t.push(o)}var r={Title:"Spherical Audio Visualizer",Volume:gt,Biquads:mt,Songs:t,drawParams:ht,Rotation:dt,SphereOptions:ft,Colors:lt,NumParticles:st,GradientData:ot};localStorage.setItem("dpsAudio",JSON.stringify(r))};window.onload=function(){vt()}})();